<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="HID UPS Responder ($(var.Platform))" Language="1033" Version="!(bind.FileVersion.filC47644A0990E401925A5FC11380A9917)" Manufacturer="Zeb Inc." UpgradeCode="311f4cde-e7d5-4d50-bdba-903c35810a28">
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" Description="Version:!(bind.FileVersion.filC47644A0990E401925A5FC11380A9917)" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="HIDUPSResponderSetup" Level="1">
      <!-- Default fragment reference, not needed -->
      <!-- <ComponentGroupRef Id="ProductComponents" /> -->

      <!-- HIDUPSResponder_Project is the list of all files generated by dotnet publish. It's in HIDUPSResponder.wxs, 
			     which is in turn generated as a BeforeBuild target and can be found in the main WiX project file, HIDUPSResponderSetup.wixproj.
				 This is a static build and does not require the .NET Core 3.1 runtime to be installed -->
      <ComponentGroupRef Id="HIDUPSResponder_Project" />
    </Feature>
  </Product>
  
  <!-- Install to C:\Program Files\ or C:\Program Files (x86) depending on the platform we choose -->
  <!-- Credit goes to StackOverflow user Dan, https://stackoverflow.com/questions/1929038/compilation-error-ice80-the-64bitcomponent-uses-32bitdirectory -->
  <!-- GitHub user DanJBower -->
  <?if $(var.Platform) = x64 ?>
    <?define Win64 = "yes" ?>
    <?define PlatformProgramFilesFolder = "ProgramFiles64Folder" ?>
  <?else ?>
    <?define Win64 = "no" ?>
    <?define PlatformProgramFilesFolder = "ProgramFilesFolder" ?>
  <?endif ?>
  
  <!-- Set the installation directory here-->
  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="$(var.PlatformProgramFilesFolder)">
        <Directory Id="INSTALLFOLDER" Name="HID UPS Responder" />
      </Directory>
    </Directory>
  </Fragment>
</Wix>
